<!DOCTYPE html>
<html>
<header>
    <title>ONNX Runtime JavaScript examples: Quick Start - Web (using bundler)</title>
</header>

<body>
    <!-- consume a single file bundle -->
    <!--script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script-->
    <script src="../node_modules/onnxruntime-web/dist/ort.all.js"></script>
    <script type="module" src="protobuf.js"></script>
    <!--script type="module" src="onnx.js"></script-->
    <script src="../test/onnx.dev.js"></script>
    <script type="module" src="onnxdecoder.js"></script>
    <script type="module">
        // import * as onnxModule from "./onnx.js";
        import * as onnxdecoder from "./onnxdecoder.js";
        console.log(onnx);
        const onnxProto = onnx.onnxproto.onnx; //onnxModule.onnx;
        async function onnxNodeToOrtNode(onnxNode){

        }

        async function main() {
            {
                const session = new onnx.Session();
                const model = await session.loadModel('dump.onnx');
                console.log(session._model);
                const nodes = session._model.graph._nodes;
                for (const node of nodes) {
                    console.log(JSON.stringify(node));
                }
            }
            ort.env.debug = true
            ort.env.logLevel = 'verbose';

            const model = onnxProto.ModelProto.create();
            model.irVersion = onnxProto.Version.IR_VERSION;
            //model.opsetImport.push(opsetImport);
            model.graph = onnxProto.GraphProto.create();

            let response = await fetch("add.json");
            response = await response.json();
            console.log(response);

            const response2 = response["cases"][0];
            console.log(response2);
            const session = (await onnxdecoder.createOnnxModel(response, onnxProto));
            console.log(await onnxdecoder.runProtoOpTestcase(session, response2));
        }
        main();
    </script>
</body>

</html>
